pipeline {
    agent any
    stages {
        stage('install playwright') {
        steps {
            bat '''
            npm i
            npx playwright install
            '''
        }
        }
        stage('test') {
        steps {
            bat 'npm test'
        }
           post {
            success {
            archiveArtifacts(artifacts: 'results-cucumber/videos/*.webm', followSymlinks: false)
            bat 'rm -rf *.webm'
            }
        }
        }
    }
    post {
        always {
            allure([
                includeProperties: true,
                jdk: '',
                properties: [[key: 'Browser', value: 'Chrome']],
                reportBuildPolicy: 'ALWAYS',
                results: [[path: 'allure-results']]
            ])
        }
    }
}