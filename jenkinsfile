pipeline {
    agent any
    stages {
        stage('install playwright') {
        steps {
            bat '''
            npm i
            npx playwright install
            '''
        }
        }
        stage('test') {
        steps {
            bat 'npm test'
        }
           post {
            success {
            archiveArtifacts(artifacts: 'results-cucumber/**', followSymlinks: true)
            bat '''
            copy environment.xml /allure-results
            rmdir /s /q results-cucumber/
            '''
            }
        }
        }
    }
    post {
        always {
            allure([
                includeProperties: false,
                jdk: '',
                properties: [],
                reportBuildPolicy: 'ALWAYS',
                results: [[path: 'allure-results']]
            ])
        }
    }
}